<!doctype html>
<html lang="en">
    <link rel="icon" type="image/x-icon" href="/public/images/favicon.png">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Admin Panel | Rojolet</title>
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
        <link
        href="https://fonts.googleapis.com/css2?family=Titan+One&family=Nunito+Sans:wght@400;700&display=swap"
        rel="stylesheet"
    />
        <style>
                        body {
                display: block;
                font-family:
                    Nunito Sans,
                    sans-serif;
                margin: 0;
                padding: 0;
                background-image: url("images/checkers.png");
                background-size: cover;
                justify-content: center;
                align-items: center;
                height: 100vh;
                text-align: center;
            }
            .container {
                display: flex;
                flex-direction: column;
                align-items: center;
                padding: 20px;
                max-width: 725px;
                height: 500px;
                width: 100%;
                background-color: #a30000;
                border-radius: 20px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                color: #fff;
                text-align: center;
                margin-left: 750px;
                margin-top: 100px;
                box-shadow: inset 0 -10px rgba(0, 0, 0, 0.2);
            }

            .nav-button {
                    background-color: #d40000;
                    display: flex;
                    justify-content: space-around;
                    margin-top: 20px;
                    width: 100%;
                    font-family: "Titan One", sans-serif;
                }
                .nav-button a {
                    text-decoration: none;
                    color: #fff;
                    background-color: #c20000;
                    padding: 10px 40px;
                    border-radius: 5px;
                    font-family: "Nunito Sans", sans-serif;
                    font-weight: 700;
                    font-size: 16px;
                    transition: background-color 0.3s;
                }
                .nav-button a:hover {
                    background-color: #a30000;
                }





                
                .nav-bar {
                    padding-right: 15px;
                    padding-left: 15px;
                    background-color: rgb(178, 9, 9);
                }
                .navdiv {
                    display: flex;
                    align-items: center;
                    background-color: #8B0000;
                    border-bottom: #6B0000 8px solid;
                    height: 100px;
                    font-family: 'Titan One', sans-serif;
                }
                .navdiv h1 {
                    color: #fff;
                }
                .logo a {
                    margin-left: 15px;
                    font-size: 35px;
                    color: #fff;
                    font-family: "Titan One", sans-serif;
                    text-decoration: none;
                }
                button {
                    background-color: #9d0000;
                    margin-left: 10px;
                    border-radius: 10px;
                    border-color: #fff;
                    padding: 10px;
                    width: 90px;
                    text-decoration: none;
                }
                button a {
                    color: white;
                    font-family: "Titan One", sans-serif;
                    font-size: 15px;
                    text-decoration: none;
                }
                .username-input {
                flex: 1;
                padding: 10px;
                border: 1px solid #8B0000;
                border-radius: 8px;
                background-color: #6B0000;
                color: white;
                height: 20px;
                width: 400px;
                margin: 5px;
            }
        </style>
    </head>
    <body> 
        <nav class="navbar">
            <div class="navdiv">
                <div class="logo"><a href="index.html">Rojolet</a></div>
                <ul>
                    <button><a href="stats.html">Stats</a></button>
                    <button><a href="chat.html">Chat</a></button>
                    <button><a href="market.html">Market</a></button>
                    <button><a href="blooks.html">Blooks</a></button>
                    <button><a href="lobby.html">Games</a></button>
                    <button><a href="guilds.html">Clans</a></button>
                    <button><a href="#">Panel</a></button>
                </ul>
            </div>
        </nav>

        <div class="container">
        <h1 style="font-family: 'Titan One', sans-serif; color: #fff;">Admin Panel</h1>

        <div>
            <label for="username"></label>
            <input 
             class="username-input"
             type="text" 
             id="username" 
             placeholder="Search User" style="font-family: 'Titan One', sans-serif;"/>
            <button onclick="searchUser()" style="color: #fff; background-color: #8b0202; height: 45px; width: 100px; font-family: 'Titan One', sans-serif; font-size: 17px;">Search</button>
        </div>

        <div id="userDetails" style="display: none">
            <h2>User Details</h2>
            <form id="userForm"></form>
            <button onclick="updateUser()">Update User</button>
        </div>
    </div>
        <script>
            const firebaseConfig = {
                apiKey: "AIzaSyCOIKlP9YhtX9xa5aoggmsrWwavlW-XuzI",
                authDomain: "cosmik-7c124.firebaseapp.com",
                databaseURL: "https://cosmik-7c124-default-rtdb.firebaseio.com",
                projectId: "cosmik-7c124",
                storageBucket: "cosmik-7c124.appspot.com",
                messagingSenderId: "412506429662",
                appId: "1:412506429662:web:9ca3e17199297df7384a4f",
                measurementId: "G-R7K0LTHCK3",
            };

            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            let currentUserDocId = null;

            function searchUser() {
                const username = document
                    .getElementById("username")
                    .value.trim();
                if (!username) {
                    alert("Please enter a username.");
                    return;
                }

                db.collection("users")
                    .where("username", "==", username)
                    .get()
                    .then((querySnapshot) => {
                        if (querySnapshot.empty) {
                            alert("No user found with that username.");
                            return;
                        }

                        querySnapshot.forEach((doc) => {
                            currentUserDocId = doc.id;
                            const userData = doc.data();
                            displayUserFields(userData);
                        });
                    })
                    .catch((error) => {
                        console.error("Error searching for user: ", error);
                    });
            }

            function displayUserFields(userData) {
                const form = document.getElementById("userForm");
                form.innerHTML = "";

                for (const key in userData) {
                    if (userData.hasOwnProperty(key)) {
                        const fieldHTML = `<div>
                    <label for="${key}">${key}</label>
                    <input type="text" id="${key}" value="${userData[key]}" />
                </div>`;
                        form.innerHTML += fieldHTML;
                    }
                }

                document.getElementById("userDetails").style.display = "block";
            }

            function updateUser() {
                if (!currentUserDocId) {
                    alert("No user selected for update.");
                    return;
                }

                const updatedData = {};
                const form = document.getElementById("userForm");
                const inputs = form.querySelectorAll("input");

                inputs.forEach((input) => {
                    const key = input.id;
                    const value = input.value;
                    updatedData[key] = value;
                });

                db.collection("users")
                    .doc(currentUserDocId)
                    .update(updatedData)
                    .then(() => {
                        alert("User updated successfully!");
                    })
                    .catch((error) => {
                        console.error("Error updating user: ", error);
                    });
            }
        </script>
    </body>
</html>
